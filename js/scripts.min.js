function loadFromCache(){var e=getParameterByName("key"),t=localStorage.getItem("godsListCache",godsListCache),s=null;if(e)try{firebaseListCache.child(e).once("value",function(e){s=e.val().list,listName=e.val().name,created=e.val().created;for(var t in s)if(s.hasOwnProperty(t)){var o=s[t];for(var n in o)if(o.hasOwnProperty(n)){godsListCache[parseInt(t)].push(o[n]),godsList[parseInt(t)]++;var i=document.getElementById(parseInt(t)+1);i.appendChild(document.getElementById(o[n]))}}for(var a in godsListCache)0==godsListCache[a].length&&document.getElementById(parseInt(a)+1).appendChild(emptyNode.cloneNode(!0));equalHeightColumns(),document.getElementById("js--list-title").value=listName,document.getElementById("js--list-date").innerHTML=moment(created).format("dddd, MM/DD/YY"),0==document.getElementById("all").getElementsByClassName("god-icon").length&&document.getElementById("js--no-gods-left").classList.remove("hide"),document.getElementById("js--loading").classList.add("hide")})}catch(o){console.log(o),alert("This god list is invalid. Please check that you copied the whole link!")}else if(null!=t)try{godsListCache=JSON.parse(t),godsListTitle=localStorage.getItem("godsListTitle",godsListTitle),[].forEach.call(godsListCache,function(e,t){0!=e.length?([].forEach.call(e,function(e,s){document.getElementById(t+1).appendChild(document.getElementById(e))}),godsList[t]=e.length):document.getElementById(t+1).appendChild(emptyNode.cloneNode(!0))}),0==document.getElementById("all").getElementsByClassName("god-icon").length&&(document.getElementById("js--publish").removeAttribute("disabled"),document.getElementById("js--no-gods-left").classList.remove("hide")),equalHeightColumns(),document.getElementById("js--list-title").value=godsListTitle,document.getElementById("js--loading").classList.add("hide")}catch(o){console.log(o),alert("Error with cached values!"),localStorage.removeItem("godsListCache")}else{var n=document.getElementsByClassName("god-icons");[].forEach.call(n,function(e){"all"!=e.id&&e.appendChild(emptyNode.cloneNode(!0))}),document.getElementById("js--loading").classList.add("hide")}updateScrollBars()}function moveGod(e){if(e.getElementsByClassName("empty").length&&e.removeChild(e.getElementsByClassName("empty")[0]),lastActiveGroup=dragSrcEl.parentNode.id,"all"!=lastActiveGroup){var t=godsListCache[lastActiveGroup-1].indexOf(dragSrcEl.id);godsListCache[lastActiveGroup-1].splice(t,1),godsList[dragSrcRowID-1]>0&&godsList[dragSrcRowID-1]--}if(0==godsList[e.id-1]||dragEnterSrcEl==dragSrcEl)e.appendChild(dragSrcEl),godsListCache[activeGroup-1].push(dragSrcEl.id);else if(leftSide){var s=godsListCache[activeGroup-1].indexOf(dragEnterSrcEl.id);0>s&&(s=0),godsListCache[activeGroup-1].splice(s,0,dragSrcEl.id),document.getElementById(activeGroup).insertBefore(dragSrcEl,dragEnterSrcEl)}else{if(dragEnterSrcEl.nextSibling){var s=godsListCache[activeGroup-1].indexOf(dragEnterSrcEl.nextSibling.id);godsListCache[activeGroup-1].splice(s,0,dragSrcEl.id)}else godsListCache[activeGroup-1].push(dragSrcEl.id);document.getElementById(activeGroup).insertBefore(dragSrcEl,dragEnterSrcEl.nextSibling)}return localStorage.setItem("godsListCache",JSON.stringify(godsListCache)),godsList[activeGroup-1]++,0==godsList[dragSrcRowID-1]&&document.getElementById(dragSrcRowID).appendChild(emptyNode).addEventListener("click",godIconEvents.click,!1),e.classList.remove("over"),lastActiveGroup=e.id,setTimeout(function(){0==document.getElementById("all").getElementsByClassName("god-icon").length&&(document.getElementById("js--publish").removeAttribute("disabled"),document.getElementById("js--no-gods-left").classList.remove("hide")),equalHeightColumns()},50),updateScrollBars(),0}function moveGods(e,t){[].forEach.call(t,function(t){if(godsList[t.parentNode.id-1]>0&&godsList[t.parentNode.id-1]--,"all"!=t.parentNode.id){var s=godsListCache[t.parentNode.id-1].indexOf(t.id);godsListCache[t.parentNode.id-1].splice(s,1)}setTimeout(function(){e.appendChild(t),setTimeout(function(){t.classList.remove("selected"),godsList[e.id-1]++},1)},1),godsListCache[e.id-1].push(t.id)}),localStorage.setItem("godsListCache",JSON.stringify(godsListCache)),e.getElementsByClassName("empty").length&&e.removeChild(e.getElementsByClassName("empty")[0]);var s=document.getElementsByClassName("add-selected");return[].forEach.call(s,function(e){e.classList.remove("show")}),setTimeout(function(){0==document.getElementById("all").getElementsByClassName("god-icon").length&&(document.getElementById("js--publish").removeAttribute("disabled"),document.getElementById("js--no-gods-left").classList.remove("hide")),equalHeightColumns()},50),updateScrollBars(),0}function equalHeightColumns(){if(document.getElementsByClassName("tier-list")[0].classList.contains("view-standard")){columns=document.getElementsByClassName("god-icons"),[].forEach.call(columns,function(e){e.style.height=""}),columns[1].clientHeight>columns[2].clientHeight?columns[2].style.height=columns[1].clientHeight+"px":columns[1].style.height=columns[2].clientHeight+"px",columns[4].clientHeight>columns[5].clientHeight?columns[5].style.height=columns[4].clientHeight+"px":columns[4].style.height=columns[5].clientHeight+"px",columns[6].clientHeight>columns[8].clientHeight?columns[8].style.height=columns[7].clientHeight+"px":columns[7].style.height=columns[8].clientHeight+"px";var e=columns[10].clientHeight;columns[11].clientHeight>e?e=columns[11].clientHeight:columns[12].clientHeight>e&&(e=columns[12].clientHeight),columns[10].style.height=e+"px",columns[11].style.height=e+"px",columns[12].style.height=e+"px"}updateScrollBars()}function addEventListeners(){groups=document.querySelectorAll(".god-icons"),cols=document.querySelectorAll(".god-icon"),titles=document.querySelectorAll(".title"),[].forEach.call(cols,function(e){e.addEventListener("dragstart",godIconEvents.dragStart,!1),e.addEventListener("dragover",godIconEvents.dragOver,!1),e.addEventListener("dragenter",godIconEvents.dragEnter,!1),e.addEventListener("drop",godIconEvents.dragDrop,!1),e.addEventListener("dragleave",godIconEvents.dragLeave,!1),e.addEventListener("dragend",godIconEvents.dragEnd,!1),e.addEventListener("click",godIconEvents.click,!1),e.addEventListener("mouseover",godIconEvents.mouseOver,!1),e.addEventListener("mouseout",godIconEvents.mouseOut,!1)}),[].forEach.call(groups,function(e){e.addEventListener("dragover",godGroupEvents.dragOver,!1),e.addEventListener("dragenter",godGroupEvents.dragEnter,!1),e.addEventListener("dragleave",godGroupEvents.dragLeave,!1),e.addEventListener("drop",godGroupEvents.dragDrop,!1),e.addEventListener("click",godGroupEvents.click,!1)}),[].forEach.call(titles,function(e){e.addEventListener("dragover",titleEvents.dragOver,!1)}),document.getElementById("all").removeEventListener("click",godGroupEvents.click),document.getElementById("js--deselect-all").addEventListener("click",deselectIcons,!1),document.getElementById("js--reset-page").addEventListener("click",resetPage,!1),document.getElementById("js--publish").addEventListener("click",publishPage,!1),document.getElementById("js--search-gods").addEventListener("keyup",searchGods,!1),document.getElementById("js--list-title").addEventListener("keyup",listTitleChange,!1),document.getElementById("js--menu-trigger").addEventListener("click",menuTriggerClick,!1),document.getElementById("js--view-standard").addEventListener("click",viewClick,!1),document.getElementById("js--view-compact").addEventListener("click",viewClick,!1),document.getElementById("js--colors-cb").addEventListener("change",colorsChange,!1)}function setDefaults(){var e=document.getElementsByClassName("tier-list")[0],t=localStorage.getItem("smitetierlist_colors");"true"==t&&(e.classList.add("colors"),document.getElementById("js--colors-cb").setAttribute("checked",!0));var s=localStorage.getItem("smitetierlist_view");e.classList.add("compact"==s?"view-compact":"view-standard")}function deselectIcons(e){var t=document.getElementsByClassName("god-icon");[].forEach.call(t,function(e){e.classList.remove("selected")});var s=document.getElementsByClassName("add-selected");[].forEach.call(s,function(e){e.classList.remove("show")})}function resetPage(e){localStorage.removeItem("godsListCache"),window.location.href="http://smitegodrankings.com/index.html"}function publishPage(e){var t=document.getElementById("js--list-title").value,s=firebaseListCache.push({name:t,created:Firebase.ServerValue.TIMESTAMP,list:godsListCache}).key();document.getElementById("publish_id").value="http://smitegodrankings.com/index.html?key="+s}function searchGods(e){var t=document.getElementById("all").getElementsByClassName("god-icon"),s=this.value.toLowerCase().replace(/\s+/g,""),o=0;[].forEach.call(t,function(e){-1==e.id.toLowerCase().replace(/\s+/g,"").indexOf(s)&&-1==e.getAttribute("data-type").toLowerCase().replace(/\s+/g,"").indexOf(s)?(e.classList.add("hide"),o++):e.classList.remove("hide")}),o==t.length?document.getElementById("js--no-gods-left").classList.remove("hide"):document.getElementById("js--no-gods-left").classList.add("hide"),updateScrollBars()}function listTitleChange(e){localStorage.setItem("godsListTitle",this.value)}function menuTriggerClick(e){var t=this.parentNode;t.parentNode.classList.add("collapse"),setTimeout(function(){t.addEventListener("click",sidebarClick,!1),this.removeEventListener("click",menuTriggerClick)},10)}function sidebarClick(e){var t=this;t.parentNode.classList.remove("collapse"),setTimeout(function(){document.getElementById("js--menu-trigger").addEventListener("click",menuTriggerClick,!1),t.removeEventListener("click",sidebarClick)},10)}function viewClick(e){this.parentNode.parentNode.classList.remove("view-standard"),this.parentNode.parentNode.classList.remove("view-compact"),"js--view-standard"==this.id?(this.parentNode.parentNode.classList.add("view-standard"),iconHalfWidth=25,equalHeightColumns(),localStorage.setItem("smitetierlist_view","standard")):"js--view-compact"==this.id&&(columns=document.getElementsByClassName("god-icons"),[].forEach.call(columns,function(e){e.style.height=""}),iconHalfWidth=20,this.parentNode.parentNode.classList.add("view-compact"),localStorage.setItem("smitetierlist_view","compact")),updateScrollBars()}function colorsChange(e){this.parentNode.parentNode.parentNode.classList.toggle("colors"),localStorage.setItem("smitetierlist_colors",this.parentNode.parentNode.parentNode.classList.contains("colors"))}function updateScrollBars(){}function getParameterByName(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),s=t.exec(location.search);return null===s?"":decodeURIComponent(s[1].replace(/\+/g," "))}var firebaseCache=new Firebase("https://smite-god-rankings.firebaseio.com/"),firebaseListCache=firebaseCache.child("lists"),rows,groups,cols,dragSrcEl=null,dragSrcRowID=null,dragEnterSrcEl=null,activeGroup=null,lastActiveGroup=null,godsList=[0,0,0,0,0,0,0,0,0,0,0,0],scrollbarList,scrollbarBin,iconHalfWidth=25,godsListCache=[[],[],[],[],[],[],[],[],[],[],[],[]],leftSide=!0,hoverTimer=null,hoverNode=document.createElement("div");hoverNode.classList.add("god-icon"),hoverNode.classList.add("empty"),hoverNode.id="add-god";var emptyNode=document.createElement("div");emptyNode.classList.add("god-icon"),emptyNode.classList.add("empty"),emptyNode.draggable=!1;var scrollbarListEl=document.getElementById("scrollbarList"),scrollbarBinEl=document.getElementById("scrollbarBin");scrollbarList=Ps.initialize(scrollbarListEl),scrollbarBin=Ps.initialize(scrollbarBinEl);var request=new XMLHttpRequest;request.open("GET","gods.json",!0),request.onload=function(){if(request.status>=200&&request.status<400){var e=JSON.parse(request.responseText),t=document.getElementById("all"),s=document.createDocumentFragment();[].forEach.call(e,function(e){var t=document.createElement("div");t.classList.add("god-icon"),t.style.backgroundImage="url('god_icons/"+e.filename+"')",t.id=e.id,t.setAttribute("data-short-id",e.short_id),t.setAttribute("data-type",e.type),t.draggable=!0,s.appendChild(t)}),t.appendChild(s),setDefaults(),addEventListeners(),loadFromCache()}else Alert("Cannot read JSON.")},request.onerror=function(){},request.send();var godIconEvents={dragStart:function(e){return dragSrcEl=this,dragSrcRowID=this.parentNode.id,activeGroup=this.parentNode.id,this.classList.add("dragger"),e.dataTransfer.setData("god_id",this.id),e.dataTransfer.effectAllowed="move",!0},dragOver:function(e){return"all"!=activeGroup&&dragSrcEl!=this&&(e.offsetX<iconHalfWidth&&0==leftSide?(leftSide=!0,0!=godsList[activeGroup-1]&&document.getElementById(this.parentNode.id).insertBefore(hoverNode,this)):e.offsetX>=iconHalfWidth&&1==leftSide&&(leftSide=!1,0!=godsList[activeGroup-1]&&document.getElementById(this.parentNode.id).insertBefore(hoverNode,this.nextSibling))),e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="move",!1},dragEnter:function(e){return dragEnterSrcEl=this,"all"!=activeGroup&&dragSrcEl!=dragEnterSrcEl&&(e.offsetX<iconHalfWidth?(leftSide=!0,0!=godsList[activeGroup-1]&&document.getElementById(this.parentNode.id).insertBefore(hoverNode,this)):(leftSide=!1,0!=godsList[activeGroup-1]&&document.getElementById(this.parentNode.id).insertBefore(hoverNode,this.nextSibling)),dragEnterSrcEl.classList.add("over")),equalHeightColumns(),!1},dragLeave:function(e){return dragEnterSrcEl.classList.remove("over"),!1},dragDrop:function(e){return e.stopPropagation&&e.stopPropagation(),godGroupEvents.dragDrop(this.parentNode),!1},dragEnd:function(e){document.getElementById(activeGroup).classList.remove("over"),[].forEach.call(cols,function(e){e.classList.remove("over")}),dragSrcEl.classList.remove("dragger");var t=document.getElementById(activeGroup),s=t.getElementsByClassName("empty")[0];return s&&t.removeChild(t.getElementsByClassName("empty")[0]),!1},click:function(e){var t=document.getElementsByClassName("selected"),s=document.getElementsByClassName("add-selected");this.classList.contains("empty")?0!=t.length&&moveGods(this.parentNode,t):this.classList.toggle("selected"),0==t.length?[].forEach.call(s,function(e){e.classList.remove("show")}):[].forEach.call(s,function(e){e.classList.add("show")})},mouseOver:function(e){},mouseOut:function(e){}},newIconEvents={dragOver:function(e){return e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="move",!1}},godGroupEvents={dragOver:function(e){return e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="move",!1},dragEnter:function(e){if(this.id!=activeGroup&&"all"!=this.id){lastActiveGroup=activeGroup,activeGroup=this.id,this.classList.add("over"),document.getElementById(lastActiveGroup).classList.remove("over");var t=document.getElementById(lastActiveGroup);t.getElementsByClassName("empty").length&&0!=godsList[lastActiveGroup-1]&&t.removeChild(t.getElementsByClassName("empty")[0]),dragEnterSrcEl=dragSrcEl}else"all"==this.id&&(document.getElementById(activeGroup).classList.remove("over"),activeGroup=this.id);return!1},dragLeave:function(e){return!1},dragDrop:function(e){var t;return t=document.getElementById(this.id?this.id:e.id),e.stopPropagation&&e.stopPropagation(),"all"!=t.id&&moveGod(t),!1},click:function(e){if(!e.target.classList.contains("god-icon")){var t=document.getElementsByClassName("selected");0!=t.length&&moveGods(this,t)}}},titleEvents={dragOver:function(e){return e.preventDefault&&e.preventDefault(),!1}};Element.prototype.remove=function(){this.parentElement.removeChild(this)},Array.prototype.move=function(e,t){this.splice(t,0,this.splice(e,1)[0])};